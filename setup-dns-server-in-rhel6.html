<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Setup DNS Server in RHEL6 - My Notebook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


<meta name="description" content="How to setup DNS server in RHEL6 by using BIND">



<meta name="keywords" content="DNS server, RHEL6">







<link rel="icon" href="/images/favicon.ico">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro|Calibri|Ubuntu">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    

    


</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    My Notebook
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/">Home</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Setup DNS Server in RHEL6
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2016-04-18T09:35:34.000Z" itemprop="datePublished">Apr 18 2016</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/linux/">linux</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>In the previous post <a href="/11gr2-scan-dns.html">11gr2 RAC SCAN DNS Configuration</a> describes 11gr2 SCAN concepts and how to setup SCAN DNS in rhel5. But as I upgraded the OS to version RHEL6, found something different wiht RHEL5, this post is explain how to setup primary and slave DNS server in RHEL6.<br><a id="more"></a></p>
<p>Below is my testing environment:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">192.168.56.101	node1		<span class="hljs-comment">#primary DNS server</span></span><br><span class="line">192.168.56.102	node2		<span class="hljs-comment">#slave DNS server</span></span><br><span class="line">192.168.56.103	node1-vip	<span class="hljs-comment">#below are node machines IP address</span></span><br><span class="line">192.168.56.104	node2-vip</span><br><span class="line">192.168.56.110 racdb-scan</span><br><span class="line">192.168.56.111 racdb-scan</span><br><span class="line">192.168.56.112 racdb-scan</span><br></pre></td></tr></table></figure>
<h3 id="1-Primary-server-setup-steps"><a href="#1-Primary-server-setup-steps" class="headerlink" title="1. Primary server setup steps"></a>1. Primary server setup steps</h3><h4 id="1-1-Install-necessary-rpms"><a href="#1-1-Install-necessary-rpms" class="headerlink" title="1.1 Install necessary rpms"></a>1.1 Install necessary rpms</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="hljs-comment"># yum install bind* -y</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-Configure-named-daemon-file"><a href="#1-2-Configure-named-daemon-file" class="headerlink" title="1.2 Configure named daemon file"></a>1.2 Configure named daemon file</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="hljs-comment"># vi /etc/named.conf</span></span><br><span class="line">[root@node1 ~]<span class="hljs-comment"># cat /etc/named.conf</span></span><br><span class="line">//</span><br><span class="line">// named.conf</span><br><span class="line">//</span><br><span class="line">// Provided by Red Hat <span class="hljs-built_in">bind</span> package to configure the ISC BIND named(8) DNS</span><br><span class="line">// server as a caching only nameserver (as a localhost DNS resolver only).</span><br><span class="line">//</span><br><span class="line">// See /usr/share/doc/<span class="hljs-built_in">bind</span>*/sample/ <span class="hljs-keyword">for</span> example named configuration files.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">options &#123;</span><br><span class="line">	listen-on port 53 &#123; 127.0.0.1; 192.168.56.101; &#125;;  //Master DNS server IP addr</span><br><span class="line">	listen-on-v6 port 53 &#123; ::1; &#125;;</span><br><span class="line">	directory 	<span class="hljs-string">"/var/named"</span>;</span><br><span class="line">	dump-file 	<span class="hljs-string">"/var/named/data/cache_dump.db"</span>;</span><br><span class="line">        statistics-file <span class="hljs-string">"/var/named/data/named_stats.txt"</span>;</span><br><span class="line">        memstatistics-file <span class="hljs-string">"/var/named/data/named_mem_stats.txt"</span>;</span><br><span class="line">	allow-query     &#123; localhost; 192.168.56.0/24; &#125;;	//define the IP range <span class="hljs-built_in">which</span> can be resolved</span><br><span class="line">    allow-transfer  &#123; localhost; 192.168.56.102; &#125;; 		// Slave DNS Servers IP</span><br><span class="line">	recursion yes;</span><br><span class="line"></span><br><span class="line">	dnssec-enable yes;</span><br><span class="line">	dnssec-validation yes;</span><br><span class="line">	dnssec-lookaside auto;</span><br><span class="line"></span><br><span class="line">	/* Path to ISC DLV key */</span><br><span class="line">	bindkeys-file <span class="hljs-string">"/etc/named.iscdlv.key"</span>;</span><br><span class="line"></span><br><span class="line">	managed-keys-directory <span class="hljs-string">"/var/named/dynamic"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file <span class="hljs-string">"data/named.run"</span>;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"."</span> IN &#123;</span><br><span class="line">	<span class="hljs-built_in">type</span> hint;</span><br><span class="line">	file <span class="hljs-string">"named.ca"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"oraclema.com"</span> IN &#123;   		//add forward zone file</span><br><span class="line">        <span class="hljs-built_in">type</span> master;</span><br><span class="line">        file <span class="hljs-string">"node1.oraclema.zero"</span>;  	//this zone file should be located at /var/named/</span><br><span class="line">        allow-update &#123; none; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"56.168.192.in-addr.arpa"</span> IN &#123;   //add reserve zone file</span><br><span class="line">        <span class="hljs-built_in">type</span> master;</span><br><span class="line">        file <span class="hljs-string">"56.168.192.local"</span>;   	//reserve zone file also located at /var/named/</span><br><span class="line">        allow-update &#123; none; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">include <span class="hljs-string">"/etc/named.rfc1912.zones"</span>;</span><br><span class="line">include <span class="hljs-string">"/etc/named.root.key"</span>;</span><br></pre></td></tr></table></figure>
<h4 id="1-4-Configure-the-forward-and-reserve-zone-file"><a href="#1-4-Configure-the-forward-and-reserve-zone-file" class="headerlink" title="1.4 Configure the forward and reserve zone file"></a>1.4 Configure the forward and reserve zone file</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="hljs-comment"># cd /var/named/</span></span><br><span class="line">[root@node1 ~]<span class="hljs-comment"># cp /var/named/named.localhost /var/named/node1.oraclema.zero</span></span><br><span class="line">[root@node1 ~]<span class="hljs-comment"># cp /var/named/named.localhost /var/named/56.168.192.local</span></span><br><span class="line">[root@node1 named]<span class="hljs-comment"># ls -ltr</span></span><br><span class="line">...</span><br><span class="line">-rw-r----- 1 root  named 1345 Apr 18 17:22 node1.oraclema.zero</span><br><span class="line">-rw-r----- 1 root  named 1099 Apr 18 17:24 56.168.192.local</span><br><span class="line">[root@node1 named]<span class="hljs-comment"># cat node1.oraclema.zero</span></span><br><span class="line"><span class="hljs-variable">$TTL</span>    86400</span><br><span class="line">@               IN SOA  node1.oraclema.com.      root.oraclema.com. (</span><br><span class="line">                                        42              ; serial (d. adams)</span><br><span class="line">                                        3H              ; refresh</span><br><span class="line">                                        15M             ; retry</span><br><span class="line">                                        1W              ; expiry</span><br><span class="line">                                        1D )            ; minimum</span><br><span class="line">@        IN      NS      node1.oraclema.com.</span><br><span class="line">@        IN      NS      node2.oraclema.com.</span><br><span class="line">@	IN	A	192.168.56.110</span><br><span class="line">@       IN      A       192.168.56.111</span><br><span class="line">@       IN      A       192.168.56.112</span><br><span class="line">@       IN      A       192.168.56.101</span><br><span class="line">@       IN      A       192.168.56.102</span><br><span class="line">@       IN      A       192.168.56.103</span><br><span class="line">@       IN      A       192.168.56.104</span><br><span class="line">racdb-scan                       IN A     192.168.56.110</span><br><span class="line">racdb-scan                       IN A     192.168.56.111</span><br><span class="line">racdb-scan                       IN A     192.168.56.112</span><br><span class="line">node1-vip                        IN A     192.168.56.103</span><br><span class="line">node2-vip                        IN A     192.168.56.104</span><br><span class="line">node1                            IN A     192.168.56.101</span><br><span class="line">node2                            IN A     192.168.56.102</span><br><span class="line"></span><br><span class="line">[root@node1 named]<span class="hljs-comment"># cat 56.168.192.local</span></span><br><span class="line"><span class="hljs-variable">$TTL</span>    86400</span><br><span class="line">@       IN      SOA     node1.oraclema.com. root.oraclema.com.  (</span><br><span class="line">                                      1997022700 ; Serial</span><br><span class="line">                                      28800      ; Refresh</span><br><span class="line">                                      14400      ; Retry</span><br><span class="line">                                      3600000    ; Expire</span><br><span class="line">                                      86400 )    ; Minimum</span><br><span class="line">@        IN      NS      node1.oraclema.com.</span><br><span class="line">@        IN      NS      node2.oraclema.com.</span><br><span class="line">@        IN      PTR	oraclema.com</span><br><span class="line">node1	IN	A	192.68.56.101</span><br><span class="line">node2	IN	A	192.168.56.102</span><br><span class="line">node1-vip	IN	A	192.168.56.103</span><br><span class="line">node2-vip	IN	A	192.168.56.104</span><br><span class="line">racdb-scan	IN	A	192.168.56.110</span><br><span class="line">racdb-scan      IN      A       192.168.56.111</span><br><span class="line">racdb-scan      IN      A       192.168.56.112</span><br><span class="line">101      IN      PTR     node1.oraclema.com.</span><br><span class="line">102      IN      PTR     node2.oraclema.com.</span><br><span class="line">110      IN      PTR     racdb-scan.oraclema.com.</span><br><span class="line">111      IN      PTR     racdb-scan.oraclema.com.</span><br><span class="line">112      IN      PTR     racdb-scan.oraclema.com.</span><br><span class="line">102      IN      PTR     node1-vip.oraclema.com.</span><br><span class="line">103      IN      PTR     node2-vip.oraclema.com.</span><br></pre></td></tr></table></figure>
<p>After edited the forward and reserve files, run a error test.</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 named]# named-checkconf /etc/named.conf</span><br><span class="line">[root@node1 named]# named-checkzone oraclema.com ./node1.oraclema.zero</span><br><span class="line">zone oraclema.com/IN: loaded serial 42</span><br><span class="line">OK</span><br><span class="line">[root@node1 named]# named-checkzone 56.168.192.in-addr.arpa ./56.168.192.local</span><br><span class="line">zone 56.168.192.in-addr.arpa/IN: loaded serial 1997022700</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<p>If no errors, the named process can be started now:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 named]# service named restart</span><br><span class="line">Stopping named: .                                          [  OK  ]</span><br><span class="line">Starting named:                                            [  OK  ]</span><br><span class="line">[root@node1 named]# chkconfig named on</span><br></pre></td></tr></table></figure>
<p>Finally, take a look at <code>dig</code> and <code>nslookup</code> command to check whether can resolve the domain or not:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 named]# dig node1.oraclema.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.8.2rc1-RedHat-9.8.2-0.17.rc1.el6_4.6 &lt;&lt;&gt;&gt; node1.oraclema.com</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 56422</span><br><span class="line">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 1</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;node1.oraclema.com.		IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">node1.oraclema.com.	86400	IN	A	192.168.56.101</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">oraclema.com.		86400	IN	NS	node2.oraclema.com.</span><br><span class="line">oraclema.com.		86400	IN	NS	node1.oraclema.com.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">node2.oraclema.com.	86400	IN	A	192.168.56.102</span><br><span class="line"></span><br><span class="line">;; Query time: 1 msec</span><br><span class="line">;; SERVER: 192.168.56.101# 53(192.168.56.101)</span><br><span class="line">;; WHEN: Mon Apr 18 18:02:13 2016</span><br><span class="line">;; MSG SIZE  rcvd: 102</span><br><span class="line"></span><br><span class="line">[root@node1 named]# nslookup node1.oraclema.com</span><br><span class="line">Server:		192.168.56.101</span><br><span class="line">Address:	192.168.56.101# 53</span><br><span class="line"></span><br><span class="line">Name:	node1.oraclema.com</span><br><span class="line">Address: 192.168.56.101</span><br></pre></td></tr></table></figure>
<h3 id="2-Slave-DNS-server-setup-steps"><a href="#2-Slave-DNS-server-setup-steps" class="headerlink" title="2. Slave DNS server setup steps"></a>2. Slave DNS server setup steps</h3><h4 id="2-1-Install-necessary-rpms"><a href="#2-1-Install-necessary-rpms" class="headerlink" title="2.1 Install necessary rpms"></a>2.1 Install necessary rpms</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# yum install bind* -y</span><br></pre></td></tr></table></figure>
<h4 id="2-2-Configure-named-daemon-file"><a href="#2-2-Configure-named-daemon-file" class="headerlink" title="2.2 Configure named daemon file"></a>2.2 Configure named daemon file</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]<span class="hljs-comment"># cat /etc/named.conf</span></span><br><span class="line">//</span><br><span class="line">// named.conf</span><br><span class="line">//</span><br><span class="line">// Provided by Red Hat <span class="hljs-built_in">bind</span> package to configure the ISC BIND named(8) DNS</span><br><span class="line">// server as a caching only nameserver (as a localhost DNS resolver only).</span><br><span class="line">//</span><br><span class="line">// See /usr/share/doc/<span class="hljs-built_in">bind</span>*/sample/ <span class="hljs-keyword">for</span> example named configuration files.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">options &#123;</span><br><span class="line">	listen-on port 53 &#123; 127.0.0.1; 192.168.56.102; &#125;;</span><br><span class="line">	listen-on-v6 port 53 &#123; ::1; &#125;;</span><br><span class="line">	directory 	<span class="hljs-string">"/var/named"</span>;</span><br><span class="line">	dump-file 	<span class="hljs-string">"/var/named/data/cache_dump.db"</span>;</span><br><span class="line">        statistics-file <span class="hljs-string">"/var/named/data/named_stats.txt"</span>;</span><br><span class="line">        memstatistics-file <span class="hljs-string">"/var/named/data/named_mem_stats.txt"</span>;</span><br><span class="line">	allow-query     &#123; localhost; 192.168.56.0/24; &#125;;	//IP address range</span><br><span class="line">	recursion yes;</span><br><span class="line"></span><br><span class="line">	dnssec-enable yes;</span><br><span class="line">	dnssec-validation yes;</span><br><span class="line">	dnssec-lookaside auto;</span><br><span class="line"></span><br><span class="line">	/* Path to ISC DLV key */</span><br><span class="line">	bindkeys-file <span class="hljs-string">"/etc/named.iscdlv.key"</span>;</span><br><span class="line"></span><br><span class="line">	managed-keys-directory <span class="hljs-string">"/var/named/dynamic"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file <span class="hljs-string">"data/named.run"</span>;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"."</span> IN &#123;</span><br><span class="line">	<span class="hljs-built_in">type</span> hint;</span><br><span class="line">	file <span class="hljs-string">"named.ca"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"oraclema.com"</span> IN &#123;   			//define forward zone file</span><br><span class="line">        <span class="hljs-built_in">type</span> slave;</span><br><span class="line">        file <span class="hljs-string">"slaves/node1.oraclema.zero"</span>;</span><br><span class="line">        masters &#123; 192.168.56.101; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="hljs-string">"56.168.192.in-addr.arpa"</span> IN &#123;   		//define reserve zone file</span><br><span class="line">        <span class="hljs-built_in">type</span> slave;</span><br><span class="line">        file <span class="hljs-string">"slaves/56.168.192.local"</span>;</span><br><span class="line">        masters &#123; 192.168.56.101; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">include <span class="hljs-string">"/etc/named.rfc1912.zones"</span>;</span><br><span class="line">include <span class="hljs-string">"/etc/named.root.key"</span>;</span><br></pre></td></tr></table></figure>
<p>After edit the named.conf file, no need to create or edit the zone files, when named process start, these files would be created automatically.</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]# service named restart</span><br><span class="line">Stopping named:                                            [  OK  ]</span><br><span class="line">Starting named:                                            [  OK  ]</span><br><span class="line">[root@node2 ~]# chkconfig named on</span><br></pre></td></tr></table></figure>
<p>The two zone files are generated automatically by named process:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]# ls -l /var/named/slaves/</span><br><span class="line">total 8</span><br><span class="line">-rw-r--r-- 1 named named 720 Apr  8 21:53 56.168.192.local</span><br><span class="line">-rw-r--r-- 1 named named 691 Apr 18 16:43 node1.oraclema.zero</span><br></pre></td></tr></table></figure>
<h4 id="2-3-Check-the-resolve-result"><a href="#2-3-Check-the-resolve-result" class="headerlink" title="2.3 Check the resolve result"></a>2.3 Check the resolve result</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]# dig node2.oraclema.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.8.2rc1-RedHat-9.8.2-0.17.rc1.el6_4.6 &lt;&lt;&gt;&gt; node2.oraclema.com</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 9104</span><br><span class="line">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 1</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;node2.oraclema.com.		IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">node2.oraclema.com.	86400	IN	A	192.168.56.102</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">oraclema.com.		86400	IN	NS	node1.oraclema.com.</span><br><span class="line">oraclema.com.		86400	IN	NS	node2.oraclema.com.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">node1.oraclema.com.	86400	IN	A	192.168.56.101</span><br><span class="line"></span><br><span class="line">;; Query time: 1 msec</span><br><span class="line">;; SERVER: 192.168.56.101# 53(192.168.56.101)</span><br><span class="line">;; WHEN: Mon Apr 18 19:05:23 2016</span><br><span class="line">;; MSG SIZE  rcvd: 102</span><br><span class="line">[root@node2 ~]# nslookup node1.oraclema.com</span><br><span class="line">Server:		192.168.56.101</span><br><span class="line">Address:	192.168.56.101# 53</span><br><span class="line"></span><br><span class="line">Name:	node1.oraclema.com</span><br><span class="line">Address: 192.168.56.101</span><br><span class="line"></span><br><span class="line">[root@node2 ~]# nslookup 192.168.56.102</span><br><span class="line">Server:		192.168.56.101</span><br><span class="line">Address:	192.168.56.101# 53</span><br><span class="line"></span><br><span class="line">102.56.168.192.in-addr.arpa	name = node1-vip.oraclema.com.</span><br><span class="line">102.56.168.192.in-addr.arpa	name = node2.oraclema.com.</span><br><span class="line">102.56.168.192.in-addr.arpa	name = node2.</span><br><span class="line">102.56.168.192.in-addr.arpa	name = node1-vip.</span><br></pre></td></tr></table></figure>
<h3 id="3-Client-setting"><a href="#3-Client-setting" class="headerlink" title="3. Client setting"></a>3. Client setting</h3><p>For this scenario, the node1 and node2 both can be treated as clients.</p>
<h4 id="3-1-Edit-the-hostname-file"><a href="#3-1-Edit-the-hostname-file" class="headerlink" title="3.1 Edit the hostname file"></a>3.1 Edit the hostname file</h4><figure class="highlight bash hljs"><figcaption><span>[Edit the hostname]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="hljs-comment"># cat /etc/sysconfig/network</span></span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=node1.oraclema.com</span><br><span class="line">GATEWAY=192.168.56.1</span><br><span class="line">NOZEROCONF=yes</span><br><span class="line">[root@node1 ~]<span class="hljs-comment"># hostname</span></span><br><span class="line">node1.oraclema.com</span><br></pre></td></tr></table></figure>
<p>No need to manually change hostname to node1.oraclema.com, when named services is effective, the hostname can turn to node1.oraclema.com automatically.</p>
<h4 id="3-2-Edit-Network-Interface-Card-setting"><a href="#3-2-Edit-Network-Interface-Card-setting" class="headerlink" title="3.2 Edit Network Interface Card setting"></a>3.2 Edit Network Interface Card setting</h4><p>This step can generate /etc/resolve.conf file as specified automatically.  Adding following line to NIC configuration files, for example, /etc/sysconfig/network-scripts/ifcfg-eth0 .</p>
<figure class="highlight bash hljs"><figcaption><span>[Edit NIC Configuration]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DNS1=192.168.56.101</span><br><span class="line">DNS2=192.168.56.102</span><br><span class="line">DOMAIN=oraclema.com</span><br></pre></td></tr></table></figure>
<h4 id="3-3-Change-the-resolve-order"><a href="#3-3-Change-the-resolve-order" class="headerlink" title="3.3 Change the resolve order"></a>3.3 Change the resolve order</h4><p>This step grantee the hostname resolve by DNS instead of hosts files /etc/hosts.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="hljs-comment"># cat /etc/host.conf</span></span><br><span class="line">order <span class="hljs-built_in">bind</span>,hosts</span><br><span class="line">multi on</span><br><span class="line">[root@node1 ~]<span class="hljs-comment"># grep -i dns /etc/nsswitch.conf |grep -v ^#</span></span><br><span class="line">hosts:      dns files</span><br></pre></td></tr></table></figure>
<p>That’s it, I can setup my SCAN in Oracle RAC environment now.</p>
<p><br><b>EOF</b><br></p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/dns/">#dns</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/rolling-upgrade-rac-from-11g-to-12c.html">Rolling Upgrade RAC from 11g to 12c</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/migrate-non-asm-to-asm-in-12c.html">Migrate non-ASM to ASM in 12c</a>
            
        </span>
    </div>
    
</article>




    </div>
</section>
    <footer class="footer footer-padding">
    <div class="container content">
            <div class="column is-narrow has-text-centered is-size-7-mobile">
                &copy; 2013 - 2018
                <a href="/">Fung Kong&nbsp;
                </a>
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
    </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
    
    
    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>